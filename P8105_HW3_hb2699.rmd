---
title: "P8105_HW3_hb2699"
author: "Han Bao"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
library(tidyverse)
library(readr)
```

```{r}
# install.packages("devtools")
devtools::install_github("p8105/p8105.datasets")
```


#Question 2
```{r}
# tidy the dataset 
accel<- read_csv(file = "./accel_data.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    activity_1:activity_1440, 
    names_to = "minute",
    values_to = "activity",
    names_prefix = "activity_", 
  ) %>% 
  mutate(
    day_of_week = recode(day,
                         "Monday" = "Weekday", 
                         "Tuesday" = "Weekday", 
                         "Wednesday" = "Weekday", 
                         "Thursday" = "Weekday", 
                         "Friday" = "Weekday", 
                         "Saturday" = "Weekend", 
                         "Sunday" = "Weekend"))
```

```{r}
nrow(accel)
ncol(accel)
```
The dataset contains 50400 rows and 6 columns.

```{r}
#aggregate the dataset across with minutes
accel %>% 
  group_by(week,day) %>% 
  summarize(total_activity=sum(activity)) %>% 
  knitr::kable(
    caption = "Total activity across minutes")
```

```{r}
accel %>% 
  group_by(minute,day) %>% 
  mutate(minute =as.numeric(minute)) %>% 
  ggplot(aes(x = minute/60, y = activity)) + 
  geom_point(aes(color = day), alpha = .5) + 
   scale_x_continuous(
    breaks = c(0, 3, 6, 9, 12, 15, 18, 21, 24),
    labels = c("0hr", "3hr", "6hr", "9hr", "12hr", "15hr", "18hr", "21hr", "24hr")) + 
  labs(
    title = "Track of Activity Time with one-minute interval",
    x = "Hours",
    y = "Activity",
    caption = "single_panel plot")+
  theme(plot.title = element_text(size=10))
#git push -f
```
From the graph we can see that the most active period of time for the 63-year-old male is between 6am and 12pm and between 15pm and 22pm. The other times during night are lack of activity because he is sleeping and the two hours lack of activity after noon may be because he's tired after the lunch. Besides, he is more active at night in weekdays than in weekends.

#Question 3
```{r}
# install.packages("devtools")
devtools::install_github("p8105/p8105.datasets",force = TRUE)
```

```{r}
library(p8105.datasets)
data("ny_noaa")
```
